<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>All-in-One Toolkit</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #fdfbfb, #ebedee);
      color: #000;
      margin: 0;
      padding: 30px;
    }
    h1, h2 {
      color: #fff;
      background: #000;
      padding: 25px;
      border-radius: 12px;
      text-align: center;
    }
    .center-menu, .global-language-picker {
      text-align: center;
      margin: 20px 0;
    }
    .center-menu button, select {
      margin: 5px;
      padding: 10px 20px;
      font-size: 1em;
      border-radius: 6px;
    }
    .section {
      display: none;
    }
    .active {
      display: block;
    }
    .toolbox {
      max-width: 800px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .toolbox input, .toolbox select, .toolbox button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 1em;
    }
    .toolbox canvas {
      display: block;
      margin: 20px auto;
    }
    .about-container {
      max-width: 800px;
      margin: auto;
      background: #f9f9f9;
      color: #000;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .linkedin-link {
      display: inline-flex;
      align-items: center;
      font-weight: bold;
      text-decoration: none;
      color: #0a66c2;
      margin-top: 1rem;
    }
    .linkedin-link i {
      margin-right: 8px;
    }
    .template-download {
      display: block;
      margin: 15px 0;
      color: #0066cc;
      text-decoration: none;
    }
    .template-download:hover {
      text-decoration: underline;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    .instructions {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }
    .download-btn {
      background: #27ae60;
      color: white;
      padding: 10px 15px;
      border-radius: 5px;
      text-decoration: none;
      display: inline-block;
      margin-top: 10px;
    }
    .download-btn:hover {
      background: #219653;
    }
  </style>
</head>
<body>
  <h1 id="mainTitle">🌐 All-in-One Toolkit</h1>
  <div class="global-language-picker">
    <label id="languageLabel">🌍 Language:</label>
    <select id="languageSelect" onchange="setLanguage()">
      <option value="en">English</option>
      <option value="pl">Polski</option>
      <option value="de">Deutsch</option>
      <option value="uk">Українська</option>
      <option value="es">Español</option>
      <option value="ru">Русский</option>
      <option value="zh">中文</option>
    </select>
  </div>
  <div class="center-menu">
    <button onclick="showSection('ical')" id="btnIcal">📅 XLS to iCal</button>
    <button onclick="showSection('qr')" id="btnQr">🔲 QR Code</button>
    <button onclick="showSection('vcard')" id="btnVcard">📇 vCard</button>
    <button onclick="showSection('file')" id="btnFile">🗂️ File Converter</button>
    <button onclick="showSection('about')" id="btnAbout">👤 About</button>
  </div>

  <!-- XLS to iCal Converter Section -->
  <div id="ical" class="section">
    <h2 id="icalTitle">📅 XLS to iCal Converter</h2>
    <div class="toolbox">
      <div class="instructions" id="icalInstructions">
        <h3 id="icalHowTo">How to use:</h3>
        <ol id="icalSteps">
          <li>Download our Excel template or use your own file</li>
          <li>Make sure your file has columns for event details</li>
          <li>Upload your Excel file below</li>
          <li>Convert and download your calendar file</li>
        </ol>
        <a href="#" class="download-btn" onclick="downloadTemplate()" id="templateDownload">
          <i class="fas fa-file-excel"></i> Download Excel Template
        </a>
      </div>

      <input type="file" id="fileInput" accept=".xls,.xlsx">
      <button onclick="convertToIcs()" id="convertBtn">Convert to ICS</button>
      <div id="filePreview" style="margin-top: 20px;"></div>
      <a id="downloadLink" class="download-btn" style="display:none; width: 100%; text-align: center;">
        <i class="fas fa-download"></i> Download ICS Calendar
      </a>
    </div>
  </div>

  <!-- QR Code Generator Section -->
  <div id="qr" class="section">
    <h2 id="qrTitle">🔲 QR Code Generator</h2>
    <div class="toolbox">
      <input type="text" id="qrText" placeholder="Enter text or URL">
      <button onclick="generateQRCode()" id="generateQrBtn">Generate QR Code</button>
      <canvas id="qrCanvas"></canvas>
    </div>
  </div>

  <!-- vCard Generator Section -->
  <div id="vcard" class="section">
    <h2 id="vcardTitle">📇 vCard Generator</h2>
    <div class="toolbox">
      <input id="name" placeholder="Full Name">
      <input id="phone" placeholder="Phone">
      <input id="email" placeholder="Email">
      <input id="company" placeholder="Company">
      <input id="website" placeholder="Website">
      <input id="address" placeholder="Address">
      <button onclick="generateVCard()" id="generateVcardBtn">Generate vCard & QR</button>
      <a id="vcardDownload" style="display:none" class="download-btn">
        <i class="fas fa-download"></i> Download vCard
      </a>
      <canvas id="vcardQR" style="display:none;"></canvas>
    </div>
  </div>

  <!-- File Converter Section -->
  <div id="file" class="section">
    <h2 id="fileTitle">🗂️ File Converter</h2>
    <div class="toolbox">
      <p style="text-align: center;" id="comingSoon">(Feature coming soon — will support file format conversions)</p>
    </div>
  </div>

  <!-- About Section -->
  <div id="about" class="section">
    <h2 id="aboutTitle">👤 About</h2>
    <div class="about-container" id="aboutContent">
      <p id="aboutText1">I'm a marketing professional with a background in office administration, technical support, and product marketing. I hold a Bachelor's degree in Marketing and am currently studying for my Master's in Marketing Management.</p>
      <p id="aboutText2">My work centers around supporting product launches, creating and maintaining marketing assets, and improving content quality using tools like Power BI, Excel, SAP, and Power Platform. I focus on practical solutions, clear communication, and making marketing more effective through technology.</p>
      <p id="aboutText3">I speak Ukrainian, Russian, Polish, English, and German, and I'm learning Spanish and Chinese. I enjoy working in international environments and collaborating across teams.</p>
      <p id="aboutText4">Outside of work, I'm passionate about travel, reading, exploring technology, staying active, and organizing events. I'm always looking to grow, improve, and take on new challenges.</p>
    </div>
    <div class="center-menu">
      <a class="linkedin-link" href="https://www.linkedin.com/in/vasyl-madei-399488247/" target="_blank">
        <i class="fab fa-linkedin"></i> <span id="linkedinText">LinkedIn Profile</span>
      </a>
    </div>
  </div>

  <script>
    // Comprehensive translations for all UI elements
    const translations = {
      en: {
        mainTitle: "🌐 All-in-One Toolkit",
        languageLabel: "🌍 Language:",
        btnIcal: "📅 XLS to iCal",
        btnQr: "🔲 QR Code",
        btnVcard: "📇 vCard",
        btnFile: "🗂️ File Converter",
        btnAbout: "👤 About",
        icalTitle: "📅 XLS to iCal Converter",
        icalHowTo: "How to use:",
        icalSteps: [
          "Download our Excel template or use your own file",
          "Make sure your file has columns for event details",
          "Upload your Excel file below",
          "Convert and download your calendar file"
        ],
        templateDownload: "Download Excel Template",
        convertBtn: "Convert to ICS",
        downloadIcs: "Download ICS Calendar",
        qrTitle: "🔲 QR Code Generator",
        generateQrBtn: "Generate QR Code",
        qrPlaceholder: "Enter text or URL",
        vcardTitle: "📇 vCard Generator",
        generateVcardBtn: "Generate vCard & QR",
        downloadVcard: "Download vCard",
        namePlaceholder: "Full Name",
        phonePlaceholder: "Phone",
        emailPlaceholder: "Email",
        companyPlaceholder: "Company",
        websitePlaceholder: "Website",
        addressPlaceholder: "Address",
        fileTitle: "🗂️ File Converter",
        comingSoon: "(Feature coming soon — will support file format conversions)",
        aboutTitle: "👤 About",
        aboutText1: "I'm a marketing professional with a background in office administration, technical support, and product marketing. I hold a Bachelor's degree in Marketing and am currently studying for my Master's in Marketing Management.",
        aboutText2: "My work centers around supporting product launches, creating and maintaining marketing assets, and improving content quality using tools like Power BI, Excel, SAP, and Power Platform. I focus on practical solutions, clear communication, and making marketing more effective through technology.",
        aboutText3: "I speak Ukrainian, Russian, Polish, English, and German, and I'm learning Spanish and Chinese. I enjoy working in international environments and collaborating across teams.",
        aboutText4: "Outside of work, I'm passionate about travel, reading, exploring technology, staying active, and organizing events. I'm always looking to grow, improve, and take on new challenges.",
        linkedinText: "LinkedIn Profile",
        noFileError: "Please upload an Excel file first",
        fileError: "Error processing file: "
      },
      pl: {
        mainTitle: "🌐 Zestaw narzędzi",
        languageLabel: "🌍 Język:",
        btnIcal: "📅 XLS na iCal",
        btnQr: "🔲 Kod QR",
        btnVcard: "📇 Wizytówka",
        btnFile: "🗂️ Konwerter plików",
        btnAbout: "👤 O mnie",
        icalTitle: "📅 Konwerter XLS na iCal",
        icalHowTo: "Instrukcja:",
        icalSteps: [
          "Pobierz nasz szablon Excel lub użyj własnego pliku",
          "Upewnij się, że plik zawiera kolumny ze szczegółami wydarzeń",
          "Prześlij swój plik Excel poniżej",
          "Konwertuj i pobierz plik kalendarza"
        ],
        templateDownload: "Pobierz szablon Excel",
        convertBtn: "Konwertuj do ICS",
        downloadIcs: "Pobierz kalendarz ICS",
        qrTitle: "🔲 Generator kodu QR",
        generateQrBtn: "Generuj kod QR",
        qrPlaceholder: "Wpisz tekst lub URL",
        vcardTitle: "📇 Generator wizytówki",
        generateVcardBtn: "Generuj wizytówkę i QR",
        downloadVcard: "Pobierz wizytówkę",
        namePlaceholder: "Pełne imię i nazwisko",
        phonePlaceholder: "Telefon",
        emailPlaceholder: "Email",
        companyPlaceholder: "Firma",
        websitePlaceholder: "Strona internetowa",
        addressPlaceholder: "Adres",
        fileTitle: "🗂️ Konwerter plików",
        comingSoon: "(Funkcja wkrótce — obsługa konwersji formatów plików)",
        aboutTitle: "👤 O mnie",
        aboutText1: "Jestem specjalistą marketingu z doświadczeniem w administracji biurowej, wsparciu technicznym i marketingu produktów. Posiadam tytuł licencjata w dziedzinie marketingu i obecnie studiuję na kierunku Zarządzanie Marketingiem (magister).",
        aboutText2: "Moja praca skupia się na wsparciu wprowadzania produktów na rynek, tworzeniu i utrzymywaniu zasobów marketingowych oraz poprawie jakości treści przy użyciu narzędzi takich jak Power BI, Excel, SAP i Power Platform. Skupiam się na praktycznych rozwiązaniach, jasnej komunikacji i zwiększaniu skuteczności marketingu poprzez technologię.",
        aboutText3: "Mówię po ukraińsku, rosyjsku, polsku, angielsku i niemiecku, a obecnie uczę się hiszpańskiego i chińskiego. Lubię pracować w międzynarodowym środowisku i współpracować z różnymi zespołami.",
        aboutText4: "Poza pracą pasjonuję się podróżami, czytaniem, eksplorowaniem technologii, aktywnością fizyczną i organizacją wydarzeń. Zawsze staram się rozwijać, doskonalić i podejmować nowe wyzwania.",
        linkedinText: "Profil LinkedIn",
        noFileError: "Najpierw prześlij plik Excel",
        fileError: "Błąd przetwarzania pliku: "
      },
      de: {
        mainTitle: "🌐 All-in-One Toolkit",
        languageLabel: "🌍 Sprache:",
        btnIcal: "📅 XLS zu iCal",
        btnQr: "🔲 QR-Code",
        btnVcard: "📇 vCard",
        btnFile: "🗂️ Dateikonverter",
        btnAbout: "👤 Über mich",
        icalTitle: "📅 XLS zu iCal Konverter",
        icalHowTo: "Anleitung:",
        icalSteps: [
          "Laden Sie unsere Excel-Vorlage herunter oder verwenden Sie Ihre eigene Datei",
          "Stellen Sie sicher, dass Ihre Datei Spalten mit Ereignisdetails enthält",
          "Laden Sie Ihre Excel-Datei unten hoch",
          "Konvertieren und laden Sie Ihre Kalenderdatei herunter"
        ],
        templateDownload: "Excel-Vorlage herunterladen",
        convertBtn: "In ICS konvertieren",
        downloadIcs: "ICS-Kalender herunterladen",
        qrTitle: "🔲 QR-Code-Generator",
        generateQrBtn: "QR-Code generieren",
        qrPlaceholder: "Text oder URL eingeben",
        vcardTitle: "📇 vCard-Generator",
        generateVcardBtn: "vCard & QR generieren",
        downloadVcard: "vCard herunterladen",
        namePlaceholder: "Vollständiger Name",
        phonePlaceholder: "Telefon",
        emailPlaceholder: "E-Mail",
        companyPlaceholder: "Firma",
        websitePlaceholder: "Webseite",
        addressPlaceholder: "Adresse",
        fileTitle: "🗂️ Dateikonverter",
        comingSoon: "(Funktion kommt bald — Unterstützung für Dateiformatkonvertierungen)",
        aboutTitle: "👤 Über mich",
        aboutText1: "Ich bin ein Marketingexperte mit Erfahrung in Büroverwaltung, technischer Unterstützung und Produktmarketing. Ich habe einen Bachelor-Abschluss in Marketing und studiere derzeit für meinen Master in Marketing Management.",
        aboutText2: "Meine Arbeit konzentriert sich auf die Unterstützung von Produkteinführungen, die Erstellung und Pflege von Marketingmaterialien sowie die Verbesserung der Inhaltsqualität mit Tools wie Power BI, Excel, SAP und Power Platform. Ich konzentriere mich auf praktische Lösungen, klare Kommunikation und die Steigerung der Marketingeffektivität durch Technologie.",
        aboutText3: "Ich spreche Ukrainisch, Russisch, Polnisch, Englisch und Deutsch und lerne derzeit Spanisch und Chinesisch. Ich arbeite gerne in internationalen Umgebungen und arbeite mit verschiedenen Teams zusammen.",
        aboutText4: "Außerhalb der Arbeit begeistere ich mich für Reisen, Lesen, Technologie, Fitness und die Organisation von Veranstaltungen. Ich strebe immer danach, mich weiterzuentwickeln, zu verbessern und neue Herausforderungen anzunehmen.",
        linkedinText: "LinkedIn-Profil",
        noFileError: "Bitte laden Sie zuerst eine Excel-Datei hoch",
        fileError: "Fehler beim Verarbeiten der Datei: "
      },
      uk: {
        mainTitle: "🌐 Універсальний набір інструментів",
        languageLabel: "🌍 Мова:",
        btnIcal: "📅 XLS до iCal",
        btnQr: "🔲 QR-код",
        btnVcard: "📇 Візитка",
        btnFile: "🗂️ Конвертер файлів",
        btnAbout: "👤 Про мене",
        icalTitle: "📅 Конвертер XLS у iCal",
        icalHowTo: "Інструкція:",
        icalSteps: [
          "Завантажте наш шаблон Excel або використовуйте власний файл",
          "Переконайтеся, що файл містить стовпці з деталями подій",
          "Завантажте свій файл Excel нижче",
          "Конвертуйте та завантажте файл календаря"
        ],
        templateDownload: "Завантажити шаблон Excel",
        convertBtn: "Конвертувати в ICS",
        downloadIcs: "Завантажити календар ICS",
        qrTitle: "🔲 Генератор QR-кодів",
        generateQrBtn: "Згенерувати QR-код",
        qrPlaceholder: "Введіть текст або URL",
        vcardTitle: "📇 Генератор візиток",
        generateVcardBtn: "Згенерувати візитку та QR",
        downloadVcard: "Завантажити візитку",
        namePlaceholder: "Повне ім'я",
        phonePlaceholder: "Телефон",
        emailPlaceholder: "Електронна пошта",
        companyPlaceholder: "Компанія",
        websitePlaceholder: "Вебсайт",
        addressPlaceholder: "Адреса",
        fileTitle: "🗂️ Конвертер файлів",
        comingSoon: "(Функція скоро буде доступна — підтримка конвертації форматів файлів)",
        aboutTitle: "👤 Про мене",
        aboutText1: "Я маркетолог з досвідом у офісному адмініструванні, технічній підтримці та продуктовому маркетингу. Я маю ступінь бакалавра з маркетингу та зараз навчаюся на магістратурі з маркетингового менеджменту.",
        aboutText2: "Моя робота зосереджена на підтримці запусків продуктів, створенні та підтримці маркетингових матеріалів та покращенні якості контенту за допомогою таких інструментів, як Power BI, Excel, SAP та Power Platform. Я зосереджуюсь на практичних рішеннях, чіткій комунікації та підвищенні ефективності маркетингу за допомогою технологій.",
        aboutText3: "Я володію українською, російською, польською, англійською та німецькою мовами, а зараз вивчаю іспанську та китайську. Мені подобається працювати в міжнародному середовищі та співпрацювати з різними командами.",
        aboutText4: "Поза роботою я захоплююся подорожами, читанням, вивченням технологій, спортом та організацією заходів. Я завжди прагну розвиватися, вдосконалюватися та приймати нові виклики.",
        linkedinText: "Профіль LinkedIn",
        noFileError: "Будь ласка, спочатку завантажте файл Excel",
        fileError: "Помилка обробки файлу: "
      },
      es: {
        mainTitle: "🌐 Kit de herramientas todo en uno",
        languageLabel: "🌍 Idioma:",
        btnIcal: "📅 XLS a iCal",
        btnQr: "🔲 Código QR",
        btnVcard: "📇 Tarjeta de visita",
        btnFile: "🗂️ Convertidor de archivos",
        btnAbout: "👤 Sobre mí",
        icalTitle: "📅 Convertidor de XLS a iCal",
        icalHowTo: "Instrucciones:",
        icalSteps: [
          "Descargue nuestra plantilla de Excel o use su propio archivo",
          "Asegúrese de que su archivo tenga columnas con detalles de eventos",
          "Suba su archivo de Excel a continuación",
          "Convierta y descargue su archivo de calendario"
        ],
        templateDownload: "Descargar plantilla de Excel",
        convertBtn: "Convertir a ICS",
        downloadIcs: "Descargar calendario ICS",
        qrTitle: "🔲 Generador de códigos QR",
        generateQrBtn: "Generar código QR",
        qrPlaceholder: "Ingrese texto o URL",
        vcardTitle: "📇 Generador de tarjetas de visita",
        generateVcardBtn: "Generar tarjeta y QR",
        downloadVcard: "Descargar tarjeta",
        namePlaceholder: "Nombre completo",
        phonePlaceholder: "Teléfono",
        emailPlaceholder: "Correo electrónico",
        companyPlaceholder: "Empresa",
        websitePlaceholder: "Sitio web",
        addressPlaceholder: "Dirección",
        fileTitle: "🗂️ Convertidor de archivos",
        comingSoon: "(Función próximamente — soporte para conversión de formatos de archivo)",
        aboutTitle: "👤 Sobre mí",
        aboutText1: "Soy un profesional de marketing con experiencia en administración de oficinas, soporte técnico y marketing de productos. Tengo una licenciatura en Marketing y actualmente estoy estudiando para mi Maestría en Gestión de Marketing.",
        aboutText2: "Mi trabajo se centra en apoyar el lanzamiento de productos, crear y mantener activos de marketing y mejorar la calidad del contenido utilizando herramientas como Power BI, Excel, SAP y Power Platform. Me enfoco en soluciones prácticas, comunicación clara y hacer que el marketing sea más efectivo a través de la tecnología.",
        aboutText3: "Hablo ucraniano, ruso, polaco, inglés y alemán, y estoy aprendiendo español y chino. Disfruto trabajar en entornos internacionales y colaborar con equipos diversos.",
        aboutText4: "Fuera del trabajo, me apasiona viajar, leer, explorar tecnología, mantenerme activo y organizar eventos. Siempre estoy buscando crecer, mejorar y asumir nuevos desafíos.",
        linkedinText: "Perfil de LinkedIn",
        noFileError: "Por favor, suba primero un archivo de Excel",
        fileError: "Error al procesar el archivo: "
      },
      ru: {
        mainTitle: "🌐 Универсальный набор инструментов",
        languageLabel: "🌍 Язык:",
        btnIcal: "📅 XLS в iCal",
        btnQr: "🔲 QR-код",
        btnVcard: "📇 Визитка",
        btnFile: "🗂️ Конвертер файлов",
        btnAbout: "👤 Обо мне",
        icalTitle: "📅 Конвертер XLS в iCal",
        icalHowTo: "Инструкция:",
        icalSteps: [
          "Скачайте наш шаблон Excel или используйте свой файл",
          "Убедитесь, что файл содержит столбцы с деталями событий",
          "Загрузите свой файл Excel ниже",
          "Конвертируйте и скачайте файл календаря"
        ],
        templateDownload: "Скачать шаблон Excel",
        convertBtn: "Конвертировать в ICS",
        downloadIcs: "Скачать календар ICS",
        qrTitle: "🔲 Генератор QR-кодов",
        generateQrBtn: "Сгенерировать QR-код",
        qrPlaceholder: "Введите текст или URL",
        vcardTitle: "📇 Генератор визиток",
        generateVcardBtn: "Сгенерировать визитку и QR",
        downloadVcard: "Скачать визитку",
        namePlaceholder: "Полное имя",
        phonePlaceholder: "Телефон",
        emailPlaceholder: "Электронная почта",
        companyPlaceholder: "Компания",
        websitePlaceholder: "Вебсайт",
        addressPlaceholder: "Адрес",
        fileTitle: "🗂️ Конвертер файлов",
        comingSoon: "(Функция скоро будет доступна — поддержка конвертации форматов файлов)",
        aboutTitle: "👤 Обо мне",
        aboutText1: "Я маркетолог с опытом работы в офисном администрировании, технической поддержке и продуктовом маркетинге. У меня есть степень бакалавра по маркетингу, и в настоящее время я учусь в магистратуре по маркетинговому менеджменту.",
        aboutText2: "Моя работа сосредоточена на поддержке запуска продуктов, создании и поддержании маркетинговых материалов и улучшении качества контента с использованием таких инструментов, как Power BI, Excel, SAP и Power Platform. Я сосредоточен на практических решениях, четкой коммуникации и повышении эффективности маркетинга с помощью технологий.",
        aboutText3: "Я говорю на украинском, русском, польском, английском и немецком языках, а сейчас изучаю испанский и китайский. Мне нравится работать в международной среде и сотрудничать с разными командами.",
        aboutText4: "Вне работы я увлекаюсь путешествиями, чтением, изучением технологий, спортом и организацией мероприятий. Я всегда стремлюсь развиваться, совершенствоваться и принимать новые вызовы.",
        linkedinText: "Профиль LinkedIn",
        noFileError: "Пожалуйста, сначала загрузите файл Excel",
        fileError: "Ошибка обработки файла: "
      },
      zh: {
        mainTitle: "🌐 多功能工具包",
        languageLabel: "🌍 语言:",
        btnIcal: "📅 XLS 转 iCal",
        btnQr: "🔲 二维码",
        btnVcard: "📇 电子名片",
        btnFile: "🗂️ 文件转换器",
        btnAbout: "👤 关于我",
        icalTitle: "📅 XLS 转 iCal 转换器",
        icalHowTo: "使用说明:",
        icalSteps: [
          "下载我们的 Excel 模板或使用您自己的文件",
          "确保您的文件包含活动详细信息的列",
          "在下方上传您的 Excel 文件",
          "转换并下载您的日历文件"
        ],
        templateDownload: "下载 Excel 模板",
        convertBtn: "转换为 ICS",
        downloadIcs: "下载 ICS 日历",
        qrTitle: "🔲 二维码生成器",
        generateQrBtn: "生成二维码",
        qrPlaceholder: "输入文本或网址",
        vcardTitle: "📇 电子名片生成器",
        generateVcardBtn: "生成电子名片和二维码",
        downloadVcard: "下载电子名片",
        namePlaceholder: "全名",
        phonePlaceholder: "电话",
        emailPlaceholder: "电子邮件",
        companyPlaceholder: "公司",
        websitePlaceholder: "网站",
        addressPlaceholder: "地址",
        fileTitle: "🗂️ 文件转换器",
        comingSoon: "(即将推出 — 支持文件格式转换)",
        aboutTitle: "👤 关于我",
        aboutText1: "我是一名营销专业人士，具有办公室管理、技术支持和产品营销背景。我拥有市场营销学士学位，目前正在攻读营销管理硕士学位。",
        aboutText2: "我的工作重点是支持产品发布、创建和维护营销资产，以及使用 Power BI、Excel、SAP 和 Power Platform 等工具提高内容质量。我专注于实用的解决方案、清晰的沟通以及通过技术使营销更有效。",
        aboutText3: "我会说乌克兰语、俄语、波兰语、英语和德语，目前正在学习西班牙语和中文。我喜欢在国际环境中工作并与不同的团队合作。",
        aboutText4: "工作之余，我热衷于旅行、阅读、探索科技、保持活跃和组织活动。我一直在寻求成长、改进和迎接新的挑战。",
        linkedinText: "LinkedIn 个人资料",
        noFileError: "请先上传 Excel 文件",
        fileError: "文件处理错误: "
      }
    };

    // Show the selected section
    function showSection(id) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // Set language for all UI elements
    function setLanguage() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      
      // Update main elements
      document.getElementById("mainTitle").textContent = t.mainTitle;
      document.getElementById("languageLabel").textContent = t.languageLabel;
      
      // Update buttons
      document.getElementById("btnIcal").textContent = t.btnIcal;
      document.getElementById("btnQr").textContent = t.btnQr;
      document.getElementById("btnVcard").textContent = t.btnVcard;
      document.getElementById("btnFile").textContent = t.btnFile;
      document.getElementById("btnAbout").textContent = t.btnAbout;
      
      // Update XLS to iCal section
      document.getElementById("icalTitle").textContent = t.icalTitle;
      document.getElementById("icalHowTo").textContent = t.icalHowTo;
      const steps = document.querySelectorAll("#icalSteps li");
      t.icalSteps.forEach((step, i) => steps[i].textContent = step);
      document.getElementById("templateDownload").innerHTML = `<i class="fas fa-file-excel"></i> ${t.templateDownload}`;
      document.getElementById("convertBtn").textContent = t.convertBtn;
      document.getElementById("downloadLink").innerHTML = `<i class="fas fa-download"></i> ${t.downloadIcs}`;
      
      // Update QR Code section
      document.getElementById("qrTitle").textContent = t.qrTitle;
      document.getElementById("generateQrBtn").textContent = t.generateQrBtn;
      document.getElementById("qrText").placeholder = t.qrPlaceholder;
      
      // Update vCard section
      document.getElementById("vcardTitle").textContent = t.vcardTitle;
      document.getElementById("generateVcardBtn").textContent = t.generateVcardBtn;
      document.getElementById("vcardDownload").innerHTML = `<i class="fas fa-download"></i> ${t.downloadVcard}`;
      document.getElementById("name").placeholder = t.namePlaceholder;
      document.getElementById("phone").placeholder = t.phonePlaceholder;
      document.getElementById("email").placeholder = t.emailPlaceholder;
      document.getElementById("company").placeholder = t.companyPlaceholder;
      document.getElementById("website").placeholder = t.websitePlaceholder;
      document.getElementById("address").placeholder = t.addressPlaceholder;
      
      // Update File Converter section
      document.getElementById("fileTitle").textContent = t.fileTitle;
      document.getElementById("comingSoon").textContent = t.comingSoon;
      
      // Update About section
      document.getElementById("aboutTitle").textContent = t.aboutTitle;
      document.getElementById("aboutText1").textContent = t.aboutText1;
      document.getElementById("aboutText2").textContent = t.aboutText2;
      document.getElementById("aboutText3").textContent = t.aboutText3;
      document.getElementById("aboutText4").textContent = t.aboutText4;
      document.getElementById("linkedinText").textContent = t.linkedinText;
    }

    /**
     * Downloads an Excel template for calendar events
     */
    function downloadTemplate() {
      const lang = document.getElementById("languageSelect").value;
      const headers = translations[lang].icalSteps[1].includes("event") ? 
        ["Start Date", "End Date", "Event Title", "Description", "Location"] :
        ["Дата начала", "Дата окончания", "Название", "Описание", "Место"];
      
      // Create template data
      const templateData = [
        headers,
        ["2023-01-01 09:00", "2023-01-01 10:00", "Meeting", "Team sync", "Room A"],
        ["2023-01-02 14:00", "2023-01-02 15:30", "Call", "Client discussion", "Zoom"],
                ["2023-01-03 10:00", "2023-01-03 12:00", "Workshop", "Training session", "Training Room"]
      ];
      
      // Create workbook
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet(templateData);
      XLSX.utils.book_append_sheet(wb, ws, "Calendar Events");
      
      // Generate and download file
      XLSX.writeFile(wb, "Calendar_Template.xlsx");
    }

    /**
     * Converts Excel file to iCal format
     */
    function convertToIcs() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      const fileInput = document.getElementById('fileInput');
      
      if (!fileInput.files.length) {
        alert(t.noFileError);
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          // Parse Excel file
          const data = new Uint8Array(e.target.result);
          const wb = XLSX.read(data, { type: 'array' });
          const ws = wb.Sheets[wb.SheetNames[0]];
          const json = XLSX.utils.sheet_to_json(ws, { header: 1 });
          
          // Show preview of the data
          showExcelPreview(json);
          
          // Generate iCal content
          let icsContent = "BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//All-in-One Toolkit//EN\nCALSCALE:GREGORIAN\n";
          
          // Process each row (skip header row)
          for (let i = 1; i < json.length; i++) {
            const row = json[i];
            if (!row[0]) continue; // Skip empty rows
            
            // Extract event details (with fallbacks)
            const startDate = formatDate(row[0]);
            const endDate = formatDate(row[1] || row[0]); // Use start date if no end date
            const summary = row[2] || "Event";
            const description = row[3] || "";
            const location = row[4] || "";
            
            // Add event to iCal
            icsContent += `BEGIN:VEVENT\n`;
            icsContent += `DTSTART:${startDate}\n`;
            icsContent += `DTEND:${endDate}\n`;
            icsContent += `SUMMARY:${summary}\n`;
            if (description) icsContent += `DESCRIPTION:${description}\n`;
            if (location) icsContent += `LOCATION:${location}\n`;
            icsContent += `END:VEVENT\n`;
          }
          
          icsContent += "END:VCALENDAR";
          
          // Create download link
          const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
          const link = document.getElementById('downloadLink');
          link.href = URL.createObjectURL(blob);
          link.style.display = 'block';
        } catch (error) {
          alert(t.fileError + error.message);
          console.error(error);
        }
      };
      reader.onerror = function() {
        alert(t.fileError);
      };
      reader.readAsArrayBuffer(fileInput.files[0]);
    }

    /**
     * Formats date string for iCal (YYYYMMDDTHHMMSS)
     */
    function formatDate(dateStr) {
      if (!dateStr) return '';
      
      // Handle different date formats
      let date;
      if (typeof dateStr === 'string') {
        // Try parsing as ISO string or local format
        date = new Date(dateStr);
        if (isNaN(date.getTime())) {
          // Try parsing Excel serial date (number of days since 1900)
          const excelDate = parseFloat(dateStr);
          if (!isNaN(excelDate)) {
            date = new Date((excelDate - 25569) * 86400 * 1000); // Convert Excel date to JS date
          }
        }
      } else if (typeof dateStr === 'number') {
        // Handle Excel serial dates
        date = new Date((dateStr - 25569) * 86400 * 1000);
      } else if (dateStr instanceof Date) {
        date = dateStr;
      }
      
      if (!date || isNaN(date.getTime())) {
        console.warn('Invalid date format:', dateStr);
        return '';
      }
      
      // Format as iCal date-time
      const pad = n => n.toString().padStart(2, '0');
      const year = date.getFullYear();
      const month = pad(date.getMonth() + 1);
      const day = pad(date.getDate());
      const hours = pad(date.getHours());
      const minutes = pad(date.getMinutes());
      const seconds = pad(date.getSeconds());
      
      return `${year}${month}${day}T${hours}${minutes}${seconds}`;
    }

    /**
     * Displays a preview of the Excel data
     */
    function showExcelPreview(data) {
      const previewDiv = document.getElementById('filePreview');
      previewDiv.innerHTML = '';
      
      if (!data || data.length === 0) {
        previewDiv.innerHTML = '<p>No data found in the file</p>';
        return;
      }
      
      // Create table element
      const table = document.createElement('table');
      const thead = document.createElement('thead');
      const tbody = document.createElement('tbody');
      
      // Add header row
      const headerRow = document.createElement('tr');
      for (let i = 0; i < data[0].length; i++) {
        const th = document.createElement('th');
        th.textContent = data[0][i] || `Column ${i+1}`;
        headerRow.appendChild(th);
      }
      thead.appendChild(headerRow);
      
      // Add data rows (limit to 5 for preview)
      const rowCount = Math.min(data.length, 6);
      for (let i = 1; i < rowCount; i++) {
        const row = document.createElement('tr');
        for (let j = 0; j < data[i].length; j++) {
          const td = document.createElement('td');
          // Format dates for display
          if (j === 0 || j === 1) {
            const dateValue = formatDateForDisplay(data[i][j]);
            td.textContent = dateValue || '';
          } else {
            td.textContent = data[i][j] || '';
          }
          row.appendChild(td);
        }
        tbody.appendChild(row);
      }
      
      table.appendChild(thead);
      table.appendChild(tbody);
      previewDiv.appendChild(table);
      
      // Show message if there are more rows
      if (data.length > 6) {
        const moreMsg = document.createElement('p');
        moreMsg.textContent = `Showing first 5 of ${data.length - 1} events...`;
        previewDiv.appendChild(moreMsg);
      }
    }

    /**
     * Formats date for display in preview table
     */
    function formatDateForDisplay(dateValue) {
      if (!dateValue) return '';
      
      let date;
      if (typeof dateValue === 'string') {
        date = new Date(dateValue);
        if (isNaN(date.getTime())) {
          const excelDate = parseFloat(dateValue);
          if (!isNaN(excelDate)) {
            date = new Date((excelDate - 25569) * 86400 * 1000);
          }
        }
      } else if (typeof dateValue === 'number') {
        date = new Date((dateValue - 25569) * 86400 * 1000);
      }
      
      if (!date || isNaN(date.getTime())) return dateValue;
      
      return date.toLocaleString();
    }

    // QR Code Generator
    function generateQRCode() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      const qrText = document.getElementById('qrText').value.trim();
      
      if (!qrText) {
        alert(t.qrPlaceholder);
        return;
      }
      
      const canvas = document.getElementById('qrCanvas');
      const qr = qrcode(0, 'H');
      qr.addData(qrText);
      qr.make();
      const ctx = canvas.getContext('2d');
      const size = 256;
      canvas.width = canvas.height = size;
      const tileW = size / qr.getModuleCount();
      const tileH = size / qr.getModuleCount();
      ctx.fillStyle = '#fff';
      ctx.fillRect(0, 0, size, size);
      
      for (let r = 0; r < qr.getModuleCount(); r++) {
        for (let c = 0; c < qr.getModuleCount(); c++) {
          if (qr.isDark(r, c)) {
            ctx.fillStyle = '#000';
            ctx.fillRect(c * tileW, r * tileH, tileW, tileH);
          }
        }
      }
    }

    // vCard Generator
    function generateVCard() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      
      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;
      const email = document.getElementById('email').value;
      
      if (!name || !phone || !email) {
        alert(t.namePlaceholder + ", " + t.phonePlaceholder + ", " + t.emailPlaceholder + " " + 
              (lang === 'en' ? "are required" : "обов'язкові"));
        return;
      }
      
      const company = document.getElementById('company').value;
      const website = document.getElementById('website').value;
      const address = document.getElementById('address').value;
      
      let vcard = `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\nTEL;TYPE=CELL:${phone}\nEMAIL:${email}`;
      if (company) vcard += `\nORG:${company}`;
      if (website) vcard += `\nURL:${website}`;
      if (address) vcard += `\nADR;TYPE=HOME:;;${address}`;
      vcard += `\nEND:VCARD`;
      
      const blob = new Blob([vcard], { type: 'text/vcard' });
      const url = URL.createObjectURL(blob);
      const link = document.getElementById('vcardDownload');
      link.href = url;
      link.download = `${name.replace(/\s+/g, '_')}_contact.vcf`;
      link.style.display = 'block';
      
      const qr = new QRious({ 
        element: document.getElementById('vcardQR'), 
        value: vcard, 
        size: 200,
        background: '#ffffff',
        foreground: '#000000'
      });
      document.getElementById('vcardQR').style.display = 'block';
    }

    // Initialize the page
    window.onload = function() {
      // Set browser language or default to English
      const browserLang = navigator.language.slice(0, 2);
      const supportedLangs = Object.keys(translations);
      const defaultLang = supportedLangs.includes(browserLang) ? browserLang : 'en';
      document.getElementById("languageSelect").value = defaultLang;
      setLanguage();
      
      showSection('ical'); // Show calendar converter by default
    };
  </script>
</body>
</html>