<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>All-in-One Toolkit</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --primary: #4361ee;
      --secondary: #3f37c9;
      --accent: #4895ef;
      --light: #f8f9fa;
      --dark: #212529;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #dfe7f5 100%);
      color: var(--dark);
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }
    
    h1, h2 {
      color: white;
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      padding: 1.5rem;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      margin-bottom: 2rem;
    }
    
    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      flex-wrap: wrap;
      gap: 1rem;
    }
    
    .language-picker {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .language-picker select {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      border: 2px solid var(--light);
      background: white;
      font-size: 1rem;
    }
    
    .tool-nav {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    
    .tool-btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      background: linear-gradient(45deg, var(--primary), var(--accent));
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .tool-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    }
    
    .section {
      display: none;
      animation: fadeIn 0.3s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .active {
      display: block;
    }
    
    .toolbox {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 5px 25px rgba(0,0,0,0.08);
      margin-bottom: 2rem;
    }
    
    .toolbox h3 {
      color: var(--secondary);
      margin-top: 0;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }
    
    .form-control {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
      outline: none;
    }
    
    .btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      text-decoration: none;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    }
    
    .btn-block {
      display: block;
      width: 100%;
    }
    
    .btn-success {
      background: linear-gradient(45deg, #2ecc71, #27ae60);
    }
    
    .qr-canvas {
      display: block;
      margin: 1.5rem auto;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      max-width: 100%;
    }
    
    .color-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin: 1.5rem 0;
    }
    
    .color-option {
      display: flex;
      flex-direction: column;
    }
    
    .color-option label {
      margin-bottom: 0.5rem;
      font-weight: 600;
    }
    
    .color-picker {
      width: 100%;
      height: 50px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    
    .template-preview {
      margin: 2rem 0;
      overflow-x: auto;
    }
    
    .template-preview h3 {
      color: var(--secondary);
      margin-bottom: 1rem;
    }
    
    .preview-table {
      width: 100%;
      border-collapse: collapse;
      box-shadow: 0 1px 10px rgba(0,0,0,0.05);
    }
    
    .preview-table th {
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      color: white;
      padding: 1rem;
      text-align: left;
    }
    
    .preview-table td {
      padding: 0.75rem 1rem;
      border-bottom: 1px solid #e9ecef;
    }
    
    .preview-table tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    
    .preview-table tr:hover {
      background-color: #f1f3f5;
    }
    
    .about-content {
      line-height: 1.6;
    }
    
    .about-content p {
      margin-bottom: 1rem;
    }
    
    .social-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      background-color: rgba(67, 97, 238, 0.1);
      transition: all 0.3s ease;
    }
    
    .social-link:hover {
      background-color: rgba(67, 97, 238, 0.2);
      transform: translateY(-2px);
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }
      
      .nav-container {
        flex-direction: column;
        align-items: stretch;
      }
      
      .tool-nav {
        justify-content: center;
      }
      
      .toolbox {
        padding: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="mainTitle">üåê All-in-One Toolkit</h1>
    
    <div class="nav-container">
      <div class="tool-nav">
        <button onclick="showSection('ical')" class="tool-btn" id="btnIcal">üìÖ XLS to iCal</button>
        <button onclick="showSection('qr')" class="tool-btn" id="btnQr">üî≤ QR Code</button>
        <button onclick="showSection('vcard')" class="tool-btn" id="btnVcard">üìá vCard</button>
        <button onclick="showSection('about')" class="tool-btn" id="btnAbout">üë§ About</button>
      </div>
      
      <div class="language-picker">
        <label id="languageLabel">üåç Language:</label>
        <select id="languageSelect" onchange="setLanguage()">
          <option value="en">English</option>
          <option value="pl">Polski</option>
          <option value="de">Deutsch</option>
          <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
          <option value="es">Espa√±ol</option>
          <option value="zh">‰∏≠Êñá</option>
        </select>
      </div>
    </div>

    <!-- XLS to iCal Converter Section -->
    <div id="ical" class="section active">
      <h2 id="icalTitle">üìÖ XLS to iCal Converter</h2>
      <div class="toolbox">
        <div class="instructions" id="icalInstructions">
          <h3 id="icalHowTo">How to use:</h3>
          <ol id="icalSteps">
            <li>Download our Excel template or use your own file</li>
            <li>Make sure your file has columns for event details</li>
            <li>Upload your Excel file below</li>
            <li>Convert and download your calendar file</li>
          </ol>
          <button onclick="downloadTemplate()" class="btn btn-success" id="templateDownload">
            <i class="fas fa-file-excel"></i> Download Excel Template
          </button>
        </div>

        <div class="form-group">
          <label for="fileInput">Select your Excel file:</label>
          <input type="file" id="fileInput" class="form-control" accept=".xls,.xlsx">
        </div>
        
        <button onclick="convertToIcs()" class="btn btn-block" id="convertBtn">
          <i class="fas fa-exchange-alt"></i> Convert to ICS
        </button>
        
        <div class="template-preview">
          <h3>Template Preview</h3>
          <table class="preview-table">
            <thead>
              <tr>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Event Title</th>
                <th>Description</th>
                <th>Location</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>2023-01-01 09:00</td>
                <td>2023-01-01 10:00</td>
                <td>Team Meeting</td>
                <td>Weekly sync</td>
                <td>Conference Room A</td>
              </tr>
              <tr>
                <td>2023-01-02 14:00</td>
                <td>2023-01-02 15:30</td>
                <td>Client Call</td>
                <td>Project discussion</td>
                <td>Zoom</td>
              </tr>
              <tr>
                <td>2023-01-03 10:00</td>
                <td>2023-01-03 12:00</td>
                <td>Workshop</td>
                <td>Training session</td>
                <td>Training Room</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <a id="downloadLink" class="btn btn-success btn-block" style="display: none;">
          <i class="fas fa-download"></i> Download ICS Calendar
        </a>
      </div>
    </div>

    <!-- QR Code Generator Section -->
    <div id="qr" class="section">
      <h2 id="qrTitle">üî≤ QR Code Generator</h2>
      <div class="toolbox">
        <div class="form-group">
          <label for="qrText" id="qrLabel">Enter text or URL:</label>
          <input type="text" id="qrText" class="form-control" placeholder="https://example.com">
        </div>
        
        <div class="color-controls">
          <div class="color-option">
            <label>Color Style:</label>
            <select id="colorStyle" class="form-control">
              <option value="solid">Solid Color</option>
              <option value="gradient">Gradient</option>
            </select>
          </div>
          <div class="color-option">
            <label for="qrColor" id="qrColorLabel">Primary Color:</label>
            <input type="color" id="qrColor" value="#000000" class="color-picker">
          </div>
          <div class="color-option" id="gradientColorOption" style="display:none">
            <label for="gradientColor" id="gradientColorLabel">Secondary Color:</label>
            <input type="color" id="gradientColor" value="#ff0000" class="color-picker">
          </div>
        </div>
        
        <button onclick="generateQRCode()" class="btn btn-block" id="generateQrBtn">
          <i class="fas fa-qrcode"></i> Generate QR Code
        </button>
        
        <canvas id="qrCanvas" class="qr-canvas" width="300" height="300"></canvas>
        
        <a id="downloadQR" class="btn btn-success btn-block" style="display: none;">
          <i class="fas fa-download"></i> <span id="downloadQrText">Download QR Code</span>
        </a>
      </div>
    </div>

    <!-- vCard Generator Section -->
    <div id="vcard" class="section">
      <h2 id="vcardTitle">üìá vCard Generator</h2>
      <div class="toolbox">
        <div class="form-group">
          <label for="name" id="nameLabel">Full Name:</label>
          <input type="text" id="name" class="form-control" placeholder="John Doe">
        </div>
        
        <div class="form-group">
          <label for="phone" id="phoneLabel">Phone:</label>
          <input type="tel" id="phone" class="form-control" placeholder="+1234567890">
        </div>
        
        <div class="form-group">
          <label for="email" id="emailLabel">Email:</label>
          <input type="email" id="email" class="form-control" placeholder="john@example.com">
        </div>
        
        <div class="form-group">
          <label for="company" id="companyLabel">Company:</label>
          <input type="text" id="company" class="form-control" placeholder="Acme Inc">
        </div>
        
        <div class="form-group">
          <label for="website" id="websiteLabel">Website:</label>
          <input type="url" id="website" class="form-control" placeholder="https://example.com">
        </div>
        
        <button onclick="generateVCard()" class="btn btn-block" id="generateVcardBtn">
          <i class="fas fa-id-card"></i> Generate vCard
        </button>
        
        <a id="vcardDownload" class="btn btn-success btn-block" style="display: none;">
          <i class="fas fa-download"></i> Download vCard
        </a>
      </div>
    </div>

    <!-- About Section -->
    <div id="about" class="section">
      <h2 id="aboutTitle">üë§ About</h2>
      <div class="toolbox">
        <div class="about-content" id="aboutContent">
          <p id="aboutText1">I'm a marketing professional with a background in office administration, technical support, and product marketing. I hold a Bachelor's degree in Marketing and am currently studying for my Master's in Marketing Management.</p>
          <p id="aboutText2">My work centers around supporting product launches, creating and maintaining marketing assets, and improving content quality using tools like Power BI, Excel, SAP, and Power Platform. I focus on practical solutions, clear communication, and making marketing more effective through technology.</p>
          <p id="aboutText3">I speak Ukrainian, Polish, English, and German, and I'm learning Spanish and Chinese. I enjoy working in international environments and collaborating across teams.</p>
          <p id="aboutText4">Outside of work, I'm passionate about travel, reading, exploring technology, staying active, and organizing events. I'm always looking to grow, improve, and take on new challenges.</p>
        </div>
        
        <a href="https://www.linkedin.com/in/vasyl-madei-399488247/" target="_blank" class="social-link">
          <i class="fab fa-linkedin"></i>
          <span id="linkedinText">LinkedIn Profile</span>
        </a>
      </div>
    </div>
  </div>

  <script>
    // Comprehensive translations for all UI elements
    const translations = {
      en: {
        mainTitle: "üåê All-in-One Toolkit",
        languageLabel: "üåç Language:",
        btnIcal: "üìÖ XLS to iCal",
        btnQr: "üî≤ QR Code",
        btnVcard: "üìá vCard",
        btnAbout: "üë§ About",
        icalTitle: "üìÖ XLS to iCal Converter",
        icalHowTo: "How to use:",
        icalSteps: [
          "Download our Excel template or use your own file",
          "Make sure your file has columns for event details",
          "Upload your Excel file below",
          "Convert and download your calendar file"
        ],
        templateDownload: "Download Excel Template",
        convertBtn: "Convert to ICS",
        downloadIcs: "Download ICS Calendar",
        qrTitle: "üî≤ QR Code Generator",
        qrLabel: "Enter text or URL:",
        qrColorLabel: "Primary Color:",
        gradientColorLabel: "Secondary Color:",
        generateQrBtn: "Generate QR Code",
        downloadQrText: "Download QR Code",
        vcardTitle: "üìá vCard Generator",
        nameLabel: "Full Name:",
        phoneLabel: "Phone:",
        emailLabel: "Email:",
        companyLabel: "Company:",
        websiteLabel: "Website:",
        generateVcardBtn: "Generate vCard",
        downloadVcard: "Download vCard",
        aboutTitle: "üë§ About",
        aboutText1: "I'm a marketing professional with a background in office administration, technical support, and product marketing. I hold a Bachelor's degree in Marketing and am currently studying for my Master's in Marketing Management.",
        aboutText2: "My work centers around supporting product launches, creating and maintaining marketing assets, and improving content quality using tools like Power BI, Excel, SAP, and Power Platform. I focus on practical solutions, clear communication, and making marketing more effective through technology.",
        aboutText3: "I speak Ukrainian, Polish, English, and German, and I'm learning Spanish and Chinese. I enjoy working in international environments and collaborating across teams.",
        aboutText4: "Outside of work, I'm passionate about travel, reading, exploring technology, staying active, and organizing events. I'm always looking to grow, improve, and take on new challenges.",
        linkedinText: "LinkedIn Profile",
        noFileError: "Please upload an Excel file first",
        fileError: "Error processing file: ",
        qrRequired: "is required"
      },
      pl: {
        mainTitle: "üåê Zestaw narzƒôdzi",
        languageLabel: "üåç Jƒôzyk:",
        btnIcal: "üìÖ XLS na iCal",
        btnQr: "üî≤ Kod QR",
        btnVcard: "üìá Wizyt√≥wka",
        btnAbout: "üë§ O mnie",
        icalTitle: "üìÖ Konwerter XLS na iCal",
        icalHowTo: "Instrukcja:",
        icalSteps: [
          "Pobierz nasz szablon Excel lub u≈ºyj w≈Çasnego pliku",
          "Upewnij siƒô, ≈ºe plik zawiera kolumny ze szczeg√≥≈Çami wydarze≈Ñ",
          "Prze≈õlij sw√≥j plik Excel poni≈ºej",
          "Konwertuj i pobierz plik kalendarza"
        ],
        templateDownload: "Pobierz szablon Excel",
        convertBtn: "Konwertuj do ICS",
        downloadIcs: "Pobierz kalendarz ICS",
        qrTitle: "üî≤ Generator kodu QR",
        qrLabel: "Wpisz tekst lub URL:",
        qrColorLabel: "Kolor podstawowy:",
        gradientColorLabel: "Kolor dodatkowy:",
        generateQrBtn: "Generuj kod QR",
        downloadQrText: "Pobierz kod QR",
        vcardTitle: "üìá Generator wizyt√≥wek",
        nameLabel: "Pe≈Çne imiƒô:",
        phoneLabel: "Telefon:",
        emailLabel: "Email:",
        companyLabel: "Firma:",
        websiteLabel: "Strona internetowa:",
        generateVcardBtn: "Generuj wizyt√≥wkƒô",
        downloadVcard: "Pobierz wizyt√≥wkƒô",
        aboutTitle: "üë§ O mnie",
        aboutText1: "Jestem specjalistƒÖ ds. marketingu z do≈õwiadczeniem w administracji biurowej, wsparciu technicznym oraz marketingu produktowym. Posiadam tytu≈Ç licencjata z marketingu i obecnie kontynuujƒô studia magisterskie na kierunku ZarzƒÖdzanie Marketingiem.",
        aboutText2: "W swojej pracy wspieram wprowadzanie produkt√≥w na rynek, tworzƒô i utrzymujƒô materia≈Çy marketingowe oraz dbam o jako≈õƒá tre≈õci, korzystajƒÖc z narzƒôdzi takich jak Power BI, Excel, SAP i Power Platform. Skupiam siƒô na praktycznych rozwiƒÖzaniach, przejrzystej komunikacji i zwiƒôkszaniu efektywno≈õci marketingu poprzez technologiƒô.",
        aboutText3: "Pos≈Çugujƒô siƒô jƒôzykiem ukrai≈Ñskim, polskim, angielskim i niemieckim, a obecnie uczƒô siƒô hiszpa≈Ñskiego i chi≈Ñskiego. Ceniƒô sobie pracƒô w miƒôdzynarodowym ≈õrodowisku i wsp√≥≈Çpracƒô miƒôdzyzespo≈ÇowƒÖ.",
        aboutText4: "Poza pracƒÖ pasjonujƒô siƒô podr√≥≈ºami, czytaniem, nowymi technologiami, aktywno≈õciƒÖ fizycznƒÖ i organizacjƒÖ wydarze≈Ñ. Zawsze dƒÖ≈ºƒô do rozwoju, doskonalenia siƒô i podejmowania nowych wyzwa≈Ñ.",
        linkedinText: "Profil LinkedIn",
        noFileError: "Najpierw prze≈õlij plik Excel",
        fileError: "B≈ÇƒÖd przetwarzania pliku: ",
        qrRequired: "jest wymagane"
      },
      de: {
        mainTitle: "üåê All-in-One Toolkit",
        languageLabel: "üåç Sprache:",
        btnIcal: "üìÖ XLS zu iCal",
        btnQr: "üî≤ QR-Code",
        btnVcard: "üìá vCard",
        btnAbout: "üë§ √úber mich",
        icalTitle: "üìÖ XLS zu iCal Konverter",
        icalHowTo: "Anleitung:",
        icalSteps: [
          "Laden Sie unsere Excel-Vorlage herunter oder verwenden Sie Ihre eigene Datei",
          "Stellen Sie sicher, dass Ihre Datei Spalten mit Ereignisdetails enth√§lt",
          "Laden Sie Ihre Excel-Datei unten hoch",
          "Konvertieren und laden Sie Ihre Kalenderdatei herunter"
        ],
        templateDownload: "Excel-Vorlage herunterladen",
        convertBtn: "In ICS konvertieren",
        downloadIcs: "ICS-Kalender herunterladen",
        qrTitle: "üî≤ QR-Code-Generator",
        qrLabel: "Text oder URL eingeben:",
        qrColorLabel: "Prim√§rfarbe:",
        gradientColorLabel: "Sekund√§rfarbe:",
        generateQrBtn: "QR-Code generieren",
        downloadQrText: "QR-Code herunterladen",
        vcardTitle: "üìá vCard-Generator",
        nameLabel: "Vollst√§ndiger Name:",
        phoneLabel: "Telefon:",
        emailLabel: "E-Mail:",
        companyLabel: "Firma:",
        websiteLabel: "Webseite:",
        generateVcardBtn: "vCard generieren",
        downloadVcard: "vCard herunterladen",
        aboutTitle: "üë§ √úber mich",
        aboutText1: "Ich bin Marketingexperte mit Erfahrung in der B√ºroverwaltung, technischer Unterst√ºtzung und Produktmarketing. Ich habe einen Bachelor-Abschluss in Marketing und studiere derzeit einen Master in Marketing Management.",
        aboutText2: "Meine Arbeit konzentriert sich auf die Unterst√ºtzung von Produkteinf√ºhrungen, die Erstellung und Pflege von Marketingmaterialien sowie die Verbesserung der Inhaltsqualit√§t mit Tools wie Power BI, Excel, SAP und Power Platform. Ich konzentriere mich auf praktische L√∂sungen, klare Kommunikation und effektiveres Marketing durch Technologie.",
        aboutText3: "Ich spreche Ukrainisch, Polnisch, Englisch und Deutsch und lerne derzeit Spanisch und Chinesisch. Ich sch√§tze die Arbeit in internationalen Umgebungen und die team√ºbergreifende Zusammenarbeit.",
        aboutText4: "Au√üerhalb der Arbeit begeistere ich mich f√ºr Reisen, Lesen, Technologie, Fitness und die Organisation von Veranstaltungen. Ich strebe st√§ndig danach, mich weiterzuentwickeln, mich zu verbessern und neue Herausforderungen anzunehmen.",
        linkedinText: "LinkedIn-Profil",
        noFileError: "Bitte laden Sie zuerst eine Excel-Datei hoch",
        fileError: "Fehler beim Verarbeiten der Datei: ",
        qrRequired: "ist erforderlich"
      },
      uk: {
        mainTitle: "üåê –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤",
        languageLabel: "üåç –ú–æ–≤–∞:",
        btnIcal: "üìÖ XLS –¥–æ iCal",
        btnQr: "üî≤ QR-–∫–æ–¥",
        btnVcard: "üìá –í—ñ–∑–∏—Ç–∫–∞",
        btnAbout: "üë§ –ü—Ä–æ –º–µ–Ω–µ",
        icalTitle: "üìÖ –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä XLS —É iCal",
        icalHowTo: "–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:",
        icalSteps: [
          "–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–∞—à —à–∞–±–ª–æ–Ω Excel –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –≤–ª–∞—Å–Ω–∏–π —Ñ–∞–π–ª",
          "–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å —Å—Ç–æ–≤–ø—Ü—ñ –∑ –¥–µ—Ç–∞–ª—è–º–∏ –ø–æ–¥—ñ–π",
          "–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å–≤—ñ–π —Ñ–∞–π–ª Excel –Ω–∏–∂—á–µ",
          "–ö–æ–Ω–≤–µ—Ä—Ç—É–π—Ç–µ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª –∫–∞–ª–µ–Ω–¥–∞—Ä—è"
        ],
        templateDownload: "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —à–∞–±–ª–æ–Ω Excel",
        convertBtn: "–ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –≤ ICS",
        downloadIcs: "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä ICS",
        qrTitle: "üî≤ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä QR-–∫–æ–¥—ñ–≤",
        qrLabel: "–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –∞–±–æ URL:",
        qrColorLabel: "–û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–ª—ñ—Ä:",
        gradientColorLabel: "–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫–æ–ª—ñ—Ä:",
        generateQrBtn: "–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ QR-–∫–æ–¥",
        downloadQrText: "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ QR-–∫–æ–¥",
        vcardTitle: "üìá –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤—ñ–∑–∏—Ç–æ–∫",
        nameLabel: "–ü–æ–≤–Ω–µ —ñ–º'—è:",
        phoneLabel: "–¢–µ–ª–µ—Ñ–æ–Ω:",
        emailLabel: "–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞:",
        companyLabel: "–ö–æ–º–ø–∞–Ω—ñ—è:",
        websiteLabel: "–í–µ–±—Å–∞–π—Ç:",
        generateVcardBtn: "–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤—ñ–∑–∏—Ç–∫—É",
        downloadVcard: "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—ñ–∑–∏—Ç–∫—É",
        aboutTitle: "üë§ –ü—Ä–æ –º–µ–Ω–µ",
        aboutText1: "–Ø –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥ –∑ –¥–æ—Å–≤—ñ–¥–æ–º —É —Å—Ñ–µ—Ä—ñ –æ—Ñ—ñ—Å–Ω–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è, —Ç–µ—Ö–Ω—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤–æ–≥–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É. –ú–∞—é —Å—Ç—É–ø—ñ–Ω—å –±–∞–∫–∞–ª–∞–≤—Ä–∞ –∑ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É —Ç–∞ –∑–∞—Ä–∞–∑ –Ω–∞–≤—á–∞—é—Å—è –Ω–∞ –º–∞–≥—ñ—Å—Ç—Ä–∞—Ç—É—Ä—ñ –∑ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É.",
        aboutText2: "–ú–æ—è —Ä–æ–±–æ—Ç–∞ –∑–æ—Å–µ—Ä–µ–¥–∂–µ–Ω–∞ –Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º—Ü—ñ –∑–∞–ø—É—Å–∫—ñ–≤ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º—Ü—ñ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤, –∞ —Ç–∞–∫–æ–∂ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—ñ —è–∫–æ—Å—Ç—ñ –∫–æ–Ω—Ç–µ–Ω—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–∫–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —è–∫ Power BI, Excel, SAP —Ç–∞ Power Platform. –Ø –∑–æ—Å–µ—Ä–µ–¥–∂—É—é—Å—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏—Ö —Ä—ñ—à–µ–Ω–Ω—è—Ö, —á—ñ—Ç–∫—ñ–π –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—ñ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π.",
        aboutText3: "–Ø –≤–æ–ª–æ–¥—ñ—é —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é, –ø–æ–ª—å—Å—å–∫–æ—é, –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é —Ç–∞ –Ω—ñ–º–µ—Ü—å–∫–æ—é –º–æ–≤–∞–º–∏, –∞ –∑–∞—Ä–∞–∑ –≤–∏–≤—á–∞—é —ñ—Å–ø–∞–Ω—Å—å–∫—É —Ç–∞ –∫–∏—Ç–∞–π—Å—å–∫—É. –ú–µ–Ω—ñ –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –≤ –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ —Ç–∞ —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏.",
        aboutText4: "–ü–æ–∑–∞ —Ä–æ–±–æ—Ç–æ—é —è –∑–∞—Ö–æ–ø–ª—é—é—Å—è –ø–æ–¥–æ—Ä–æ–∂–∞–º–∏, —á–∏—Ç–∞–Ω–Ω—è–º, —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è–º–∏, —Å–ø–æ—Ä—Ç–æ–º —Ç–∞ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—î—é –∑–∞—Ö–æ–¥—ñ–≤. –Ø –∑–∞–≤–∂–¥–∏ –ø—Ä–∞–≥–Ω—É —Ä–æ–∑–≤–∏–≤–∞—Ç–∏—Å—è, –≤–¥–æ—Å–∫–æ–Ω–∞–ª—é–≤–∞—Ç–∏—Å—è —Ç–∞ –ø—Ä–∏–π–º–∞—Ç–∏ –Ω–æ–≤—ñ –≤–∏–∫–ª–∏–∫–∏.",
        linkedinText: "–ü—Ä–æ—Ñ—ñ–ª—å LinkedIn",
        noFileError: "–ë—É–¥—å –ª–∞—Å–∫–∞, —Å–ø–æ—á–∞—Ç–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª Excel",
        fileError: "–ü–æ–º–∏–ª–∫–∞ –æ–±—Ä–æ–±–∫–∏ —Ñ–∞–π–ª—É: ",
        qrRequired: "–æ–±–æ–≤'—è–∑–∫–æ–≤–µ –ø–æ–ª–µ"
      },
      es: {
        mainTitle: "üåê Kit de herramientas todo en uno",
        languageLabel: "üåç Idioma:",
        btnIcal: "üìÖ XLS a iCal",
        btnQr: "üî≤ C√≥digo QR",
        btnVcard: "üìá Tarjeta de contacto",
        btnAbout: "üë§ Sobre m√≠",
        icalTitle: "üìÖ Convertidor de XLS a iCal",
        icalHowTo: "Instrucciones:",
        icalSteps: [
          "Descargue nuestra plantilla de Excel o use su propio archivo",
          "Aseg√∫rese de que su archivo tenga columnas con detalles de eventos",
          "Suba su archivo de Excel a continuaci√≥n",
          "Convierta y descargue su archivo de calendario"
        ],
        templateDownload: "Descargar plantilla de Excel",
        convertBtn: "Convertir a ICS",
        downloadIcs: "Descargar calendario ICS",
        qrTitle: "üî≤ Generador de c√≥digos QR",
        qrLabel: "Ingrese texto o URL:",
        qrColorLabel: "Color primario:",
        gradientColorLabel: "Color secundario:",
        generateQrBtn: "Generar c√≥digo QR",
        downloadQrText: "Descargar c√≥digo QR",
        vcardTitle: "üìá Generador de tarjetas de contacto",
        nameLabel: "Nombre completo:",
        phoneLabel: "Tel√©fono:",
        emailLabel: "Correo electr√≥nico:",
        companyLabel: "Empresa:",
        websiteLabel: "Sitio web:",
        generateVcardBtn: "Generar tarjeta",
        downloadVcard: "Descargar tarjeta",
        aboutTitle: "üë§ Sobre m√≠",
        aboutText1: "Soy un profesional de marketing con experiencia en administraci√≥n de oficinas, soporte t√©cnico y marketing de productos. Tengo una licenciatura en Marketing y actualmente estoy estudiando una Maestr√≠a en Gesti√≥n de Marketing.",
        aboutText2: "Mi trabajo se centra en apoyar lanzamientos de productos, crear y mantener materiales de marketing y mejorar la calidad del contenido utilizando herramientas como Power BI, Excel, SAP y Power Platform. Me enfoco en soluciones pr√°cticas, comunicaci√≥n clara y hacer que el marketing sea m√°s efectivo a trav√©s de la tecnolog√≠a.",
        aboutText3: "Hablo ucraniano, polaco, ingl√©s y alem√°n, y actualmente estoy aprendiendo espa√±ol y chino. Disfruto trabajar en entornos internacionales y colaborar entre equipos.",
        aboutText4: "Fuera del trabajo, me apasiona viajar, leer, explorar tecnolog√≠a, mantenerme activo y organizar eventos. Siempre estoy buscando crecer, mejorar y asumir nuevos desaf√≠os.",
        linkedinText: "Perfil de LinkedIn",
        noFileError: "Por favor, suba primero un archivo de Excel",
        fileError: "Error al procesar el archivo: ",
        qrRequired: "es requerido"
      },
      zh: {
        mainTitle: "üåê Â§öÂäüËÉΩÂ∑•ÂÖ∑ÂåÖ",
        languageLabel: "üåç ËØ≠Ë®Ä:",
        btnIcal: "üìÖ XLS ËΩ¨ iCal",
        btnQr: "üî≤ ‰∫åÁª¥Á†Å",
        btnVcard: "üìá ÁîµÂ≠êÂêçÁâá",
        btnAbout: "üë§ ÂÖ≥‰∫éÊàë",
        icalTitle: "üìÖ XLS ËΩ¨ iCal ËΩ¨Êç¢Âô®",
        icalHowTo: "‰ΩøÁî®ËØ¥Êòé:",
        icalSteps: [
          "‰∏ãËΩΩÊàë‰ª¨ÁöÑ Excel Ê®°ÊùøÊàñ‰ΩøÁî®ÊÇ®Ëá™Â∑±ÁöÑÊñá‰ª∂",
          "Á°Æ‰øùÊÇ®ÁöÑÊñá‰ª∂ÂåÖÂê´Ê¥ªÂä®ËØ¶ÁªÜ‰ø°ÊÅØÁöÑÂàó",
          "Âú®‰∏ãÊñπ‰∏ä‰º†ÊÇ®ÁöÑ Excel Êñá‰ª∂",
          "ËΩ¨Êç¢Âπ∂‰∏ãËΩΩÊÇ®ÁöÑÊó•ÂéÜÊñá‰ª∂"
        ],
        templateDownload: "‰∏ãËΩΩ Excel Ê®°Êùø",
        convertBtn: "ËΩ¨Êç¢‰∏∫ ICS",
        downloadIcs: "‰∏ãËΩΩ ICS Êó•ÂéÜ",
        qrTitle: "üî≤ ‰∫åÁª¥Á†ÅÁîüÊàêÂô®",
        qrLabel: "ËæìÂÖ•ÊñáÊú¨ÊàñÁΩëÂùÄ:",
        qrColorLabel: "‰∏ªË¶ÅÈ¢úËâ≤:",
        gradientColorLabel: "Ê¨°Ë¶ÅÈ¢úËâ≤:",
        generateQrBtn: "ÁîüÊàê‰∫åÁª¥Á†Å",
        downloadQrText: "‰∏ãËΩΩ‰∫åÁª¥Á†Å",
        vcardTitle: "üìá ÁîµÂ≠êÂêçÁâáÁîüÊàêÂô®",
        nameLabel: "ÂÖ®Âêç:",
        phoneLabel: "ÁîµËØù:",
        emailLabel: "ÁîµÂ≠êÈÇÆ‰ª∂:",
        companyLabel: "ÂÖ¨Âè∏:",
        websiteLabel: "ÁΩëÁ´ô:",
        generateVcardBtn: "ÁîüÊàêÁîµÂ≠êÂêçÁâá",
        downloadVcard: "‰∏ãËΩΩÁîµÂ≠êÂêçÁâá",
        aboutTitle: "üë§ ÂÖ≥‰∫éÊàë",
        aboutText1: "ÊàëÊòØ‰∏ÄÂêçÂ∏ÇÂú∫Ëê•ÈîÄ‰∏ì‰∏ö‰∫∫Â£´ÔºåÊã•ÊúâÂäûÂÖ¨ÂÆ§ÁÆ°ÁêÜ„ÄÅÊäÄÊúØÊîØÊåÅÂíå‰∫ßÂìÅËê•ÈîÄÊñπÈù¢ÁöÑËÉåÊôØ„ÄÇÊàëÂèñÂæó‰∫ÜÂ∏ÇÂú∫Ëê•ÈîÄÂ≠¶Â£´Â≠¶‰ΩçÔºåÁõÆÂâçÊ≠£Âú®ÊîªËØªÂ∏ÇÂú∫Ëê•ÈîÄÁÆ°ÁêÜÁ°ïÂ£´Â≠¶‰Ωç„ÄÇ",
        aboutText2: "ÊàëÁöÑÂ∑•‰ΩúÈáçÁÇπÂåÖÊã¨ÊîØÊåÅ‰∫ßÂìÅÂèëÂ∏É„ÄÅÂàõÂª∫Âπ∂Áª¥Êä§Ëê•ÈîÄËµÑ‰∫ßÔºå‰ª•ÂèäÂÄüÂä© Power BI„ÄÅExcel„ÄÅSAP Âíå Power Platform Á≠âÂ∑•ÂÖ∑ÊèêÂçáÂÜÖÂÆπË¥®Èáè„ÄÇÊàëÊ≥®ÈáçÂÆûÁî®ÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÅÊ∏ÖÊô∞ÁöÑÊ≤üÈÄöÔºåÂπ∂Ëá¥Âäõ‰∫éÈÄöËøáÊäÄÊúØÊèêÂçáËê•ÈîÄÁöÑÊïàÊûú„ÄÇ",
        aboutText3: "Êàë‰ºöËØ¥‰πåÂÖãÂÖ∞ËØ≠„ÄÅÊ≥¢ÂÖ∞ËØ≠„ÄÅËã±ËØ≠ÂíåÂæ∑ËØ≠ÔºåÁõÆÂâçÊ≠£Âú®Â≠¶‰π†Ë•øÁè≠ÁâôËØ≠Âíå‰∏≠Êñá„ÄÇÊàëÁÉ≠Ë°∑‰∫éÂú®ÂõΩÈôÖÁéØÂ¢É‰∏≠Â∑•‰ΩúÔºåÂπ∂‰πê‰∫é‰∏é‰∏çÂêåÂõ¢ÈòüÂ±ïÂºÄÂêà‰Ωú„ÄÇ",
        aboutText4: "Â∑•‰Ωú‰πã‰ΩôÔºåÊàëÂñúÊ¨¢ÊóÖË°å„ÄÅÈòÖËØª„ÄÅÊé¢Á¥¢ÁßëÊäÄ„ÄÅ‰øùÊåÅÊ¥ªË∑ÉÂπ∂ÁªÑÁªáÂêÑÁ±ªÊ¥ªÂä®„ÄÇÊàëÂßãÁªàËá¥Âäõ‰∫é‰∏çÊñ≠ÊàêÈïø„ÄÅÊåÅÁª≠ÊèêÂçáÔºåÂπ∂Âãá‰∫éËøéÊé•Êñ∞ÁöÑÊåëÊàò„ÄÇ",
        linkedinText: "LinkedIn ‰∏™‰∫∫ËµÑÊñô",
        noFileError: "ËØ∑ÂÖà‰∏ä‰º† Excel Êñá‰ª∂",
        fileError: "Êñá‰ª∂Â§ÑÁêÜÈîôËØØ: ",
        qrRequired: "ÊòØÂøÖÂ°´È°π"
      }
    };

    // Show the selected section
    function showSection(id) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // Set language for all UI elements
    function setLanguage() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      
      // Update main elements
      document.getElementById("mainTitle").textContent = t.mainTitle;
      document.getElementById("languageLabel").textContent = t.languageLabel;
      
      // Update buttons
      document.getElementById("btnIcal").textContent = t.btnIcal;
      document.getElementById("btnQr").textContent = t.btnQr;
      document.getElementById("btnVcard").textContent = t.btnVcard;
      document.getElementById("btnAbout").textContent = t.btnAbout;
      
      // Update XLS to iCal section
      document.getElementById("icalTitle").textContent = t.icalTitle;
      document.getElementById("icalHowTo").textContent = t.icalHowTo;
      const steps = document.querySelectorAll("#icalSteps li");
      t.icalSteps.forEach((step, i) => steps[i].textContent = step);
      document.getElementById("templateDownload").innerHTML = `<i class="fas fa-file-excel"></i> ${t.templateDownload}`;
      document.getElementById("convertBtn").innerHTML = `<i class="fas fa-exchange-alt"></i> ${t.convertBtn}`;
      document.getElementById("downloadLink").innerHTML = `<i class="fas fa-download"></i> ${t.downloadIcs}`;
      
      // Update QR Code section
      document.getElementById("qrTitle").textContent = t.qrTitle;
      document.getElementById("qrLabel").textContent = t.qrLabel;
      document.getElementById("qrColorLabel").textContent = t.qrColorLabel;
      document.getElementById("gradientColorLabel").textContent = t.gradientColorLabel;
      document.getElementById("generateQrBtn").innerHTML = `<i class="fas fa-qrcode"></i> ${t.generateQrBtn}`;
      document.getElementById("downloadQrText").textContent = t.downloadQrText;
      document.getElementById("qrText").placeholder = t.qrLabel.replace(':', '');
      
      // Update vCard section
      document.getElementById("vcardTitle").textContent = t.vcardTitle;
      document.getElementById("nameLabel").textContent = t.nameLabel;
      document.getElementById("phoneLabel").textContent = t.phoneLabel;
      document.getElementById("emailLabel").textContent = t.emailLabel;
      document.getElementById("companyLabel").textContent = t.companyLabel;
      document.getElementById("websiteLabel").textContent = t.websiteLabel;
      document.getElementById("generateVcardBtn").innerHTML = `<i class="fas fa-id-card"></i> ${t.generateVcardBtn}`;
      document.getElementById("vcardDownload").innerHTML = `<i class="fas fa-download"></i> ${t.downloadVcard}`;
      
      // Update About section
      document.getElementById("aboutTitle").textContent = t.aboutTitle;
      document.getElementById("aboutText1").textContent = t.aboutText1;
      document.getElementById("aboutText2").textContent = t.aboutText2;
      document.getElementById("aboutText3").textContent = t.aboutText3;
      document.getElementById("aboutText4").textContent = t.aboutText4;
      document.getElementById("linkedinText").textContent = t.linkedinText;
    }

    /**
     * Downloads an Excel template for calendar events
     */
    function downloadTemplate() {
      const lang = document.getElementById("languageSelect").value;
      const headers = translations[lang].icalSteps[1].includes("event") ? 
        ["Start Date", "End Date", "Event Title", "Description", "Location"] :
        ["Start Date", "End Date", "Event Title", "Description", "Location"];
      
      // Create template data
      const templateData = [
        headers,
        ["2023-01-01 09:00", "2023-01-01 10:00", "Meeting", "Team sync", "Room A"],
        ["2023-01-02 14:00", "2023-01-02 15:30", "Call", "Client discussion", "Zoom"],
        ["2023-01-03 10:00", "2023-01-03 12:00", "Workshop", "Training session", "Training Room"]
      ];
      
      // Create workbook
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet(templateData);
      XLSX.utils.book_append_sheet(wb, ws, "Calendar Events");
      
      // Generate and download file
      XLSX.writeFile(wb, "Calendar_Template.xlsx");
    }

    /**
     * Converts Excel file to iCal format
     */
    function convertToIcs() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      const fileInput = document.getElementById('fileInput');
      
      if (!fileInput.files.length) {
        alert(t.noFileError);
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          // Parse Excel file
          const data = new Uint8Array(e.target.result);
          const wb = XLSX.read(data, { type: 'array' });
          const ws = wb.Sheets[wb.SheetNames[0]];
          const json = XLSX.utils.sheet_to_json(ws, { header: 1 });
          
          // Generate iCal content
          let icsContent = "BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//All-in-One Toolkit//EN\nCALSCALE:GREGORIAN\n";
          
          // Process each row (skip header row)
          for (let i = 1; i < json.length; i++) {
            const row = json[i];
            if (!row[0]) continue; // Skip empty rows
            
            // Extract event details (with fallbacks)
            const startDate = formatDate(row[0]);
            const endDate = formatDate(row[1] || row[0]); // Use start date if no end date
            const summary = row[2] || "Event";
            const description = row[3] || "";
            const location = row[4] || "";
            
            // Add event to iCal
            icsContent += `BEGIN:VEVENT\n`;
            icsContent += `DTSTART:${startDate}\n`;
            icsContent += `DTEND:${endDate}\n`;
            icsContent += `SUMMARY:${summary}\n`;
            if (description) icsContent += `DESCRIPTION:${description}\n`;
            if (location) icsContent += `LOCATION:${location}\n`;
            icsContent += `END:VEVENT\n`;
          }
          
          icsContent += "END:VCALENDAR";
          
          // Create download link
          const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
          const link = document.getElementById('downloadLink');
          link.href = URL.createObjectURL(blob);
          link.style.display = 'block';
        } catch (error) {
          alert(t.fileError + error.message);
          console.error(error);
        }
      };
      reader.onerror = function() {
        alert(t.fileError);
      };
      reader.readAsArrayBuffer(fileInput.files[0]);
    }

    /**
     * Formats date string for iCal (YYYYMMDDTHHMMSS)
     */
    function formatDate(dateStr) {
      if (!dateStr) return '';
      
      // Handle different date formats
      let date;
      if (typeof dateStr === 'string') {
        // Try parsing as ISO string or local format
        date = new Date(dateStr);
        if (isNaN(date.getTime())) {
          // Try parsing Excel serial date (number of days since 1900)
          const excelDate = parseFloat(dateStr);
          if (!isNaN(excelDate)) {
            date = new Date((excelDate - 25569) * 86400 * 1000); // Convert Excel date to JS date
          }
        }
      } else if (typeof dateStr === 'number') {
        // Handle Excel serial dates
        date = new Date((dateStr - 25569) * 86400 * 1000);
      } else if (dateStr instanceof Date) {
        date = dateStr;
      }
      
      if (!date || isNaN(date.getTime())) {
        console.warn('Invalid date format:', dateStr);
        return '';
      }
      
      // Format as iCal date-time
      const pad = n => n.toString().padStart(2, '0');
      const year = date.getFullYear();
      const month = pad(date.getMonth() + 1);
      const day = pad(date.getDate());
      const hours = pad(date.getHours());
      const minutes = pad(date.getMinutes());
      const seconds = pad(date.getSeconds());
      
      return `${year}${month}${day}T${hours}${minutes}${seconds}`;
    }

    /**
     * Generates QR code with custom colors
     */
    function generateQRCode() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      const text = document.getElementById('qrText').value.trim();
      const colorStyle = document.getElementById('colorStyle').value;
      const primaryColor = document.getElementById('qrColor').value;
      const secondaryColor = document.getElementById('gradientColor').value;
      const canvas = document.getElementById('qrCanvas');
      const ctx = canvas.getContext('2d');
      const downloadBtn = document.getElementById('downloadQR');
      
      if (!text) {
        alert(t.qrLabel.replace(':', '') + " " + t.qrRequired);
        return;
      }
      
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      try {
        const qr = qrcode(0, 'H'); // Error correction level: High
        qr.addData(text);
        qr.make();
        
        // Calculate module size
        const moduleCount = qr.getModuleCount();
        const tileSize = Math.min(canvas.width, canvas.height) / moduleCount;
        
        // Draw white background
        ctx.fillStyle = "#ffffff";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // Set fill style (solid or gradient)
        let fillStyle;
        if (colorStyle === 'gradient') {
          const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
          gradient.addColorStop(0, primaryColor);
          gradient.addColorStop(1, secondaryColor);
          fillStyle = gradient;
        } else {
          fillStyle = primaryColor;
        }
        
        // Draw QR code modules
        ctx.fillStyle = fillStyle;
        for (let r = 0; r < moduleCount; r++) {
          for (let c = 0; c < moduleCount; c++) {
            if (qr.isDark(r, c)) {
              ctx.fillRect(
                c * tileSize + (canvas.width - moduleCount * tileSize)/2, 
                r * tileSize + (canvas.height - moduleCount * tileSize)/2, 
                tileSize, 
                tileSize
              );
            }
          }
        }
        
        // Set up download button
        downloadBtn.href = canvas.toDataURL('image/png');
        downloadBtn.download = text.substring(0, 20).replace(/[^a-z0-9]/gi, '_') + '_qrcode.png';
        downloadBtn.style.display = 'block';
        
      } catch (error) {
        console.error("QR generation error:", error);
        alert("Error generating QR code: " + error.message);
      }
    }

    /**
     * Generates vCard with contact information
     */
    function generateVCard() {
      const lang = document.getElementById("languageSelect").value;
      const t = translations[lang];
      
      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;
      const email = document.getElementById('email').value;
      
      if (!name || !phone || !email) {
        alert(t.nameLabel.replace(':', '') + ", " + 
              t.phoneLabel.replace(':', '') + ", " + 
              t.emailLabel.replace(':', '') + " " + 
              t.qrRequired);
        return;
      }
      
      const company = document.getElementById('company').value;
      const website = document.getElementById('website').value;
      
      // Generate vCard content
      let vcard = `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\nTEL;TYPE=CELL:${phone}\nEMAIL:${email}`;
      if (company) vcard += `\nORG:${company}`;
      if (website) vcard += `\nURL:${website}`;
      vcard += `\nEND:VCARD`;
      
      // Create download link
      const blob = new Blob([vcard], { type: 'text/vcard' });
      const url = URL.createObjectURL(blob);
      const link = document.getElementById('vcardDownload');
      link.href = url;
      link.download = `${name.replace(/\s+/g, '_')}_contact.vcf`;
      link.style.display = 'block';
    }

    // Initialize the page
    window.onload = function() {
      // Set browser language or default to English
      const browserLang = navigator.language.slice(0, 2);
      const supportedLangs = Object.keys(translations);
      const defaultLang = supportedLangs.includes(browserLang) ? browserLang : 'en';
      document.getElementById("languageSelect").value = defaultLang;
      setLanguage();
      
      // Initialize QR code section
      document.getElementById('colorStyle').addEventListener('change', function() {
        const gradientOption = document.getElementById('gradientColorOption');
        gradientOption.style.display = this.value === 'gradient' ? 'block' : 'none';
      });
      
      // Generate default QR code
      document.getElementById('qrText').value = 'https://example.com';
      generateQRCode();
      
      showSection('ical'); // Show calendar converter by default
    };
  </script>
</body>
</html>